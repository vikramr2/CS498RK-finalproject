{"ast":null,"code":"var _jsxFileName = \"/Users/vikram/Documents/School/CS498RK/finalproject/src/components/Scheduler/schedule.js\",\n    _s = $RefreshSig$();\n\nimport * as React from 'react';\nimport { useAuthState } from '../auth/firebase';\nimport { getAuth, signOut } from '@firebase/auth';\nimport { Button, Tabs, Tab, Box, Grid, Typography } from '@mui/material';\nimport CalendarTodayIcon from '@mui/icons-material/CalendarToday';\nimport SearchIcon from '@mui/icons-material/Search';\nimport LogoutIcon from '@mui/icons-material/Logout';\nimport mapSchedules from \"./appointments\";\nimport checkConflict from \"./checkConflict\";\nimport ScheduleGenerator from \"./schedulegenerator\";\nimport Recommender from './recommender';\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction TabPanel(props) {\n  const {\n    children,\n    value,\n    index,\n    ...other\n  } = props;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    role: \"tabpanel\",\n    hidden: value !== index,\n    id: `simple-tabpanel-${index}`,\n    \"aria-labelledby\": `simple-tab-${index}`,\n    ...other,\n    children: value === index && /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        p: 3\n      },\n      children: /*#__PURE__*/_jsxDEV(Typography, {\n        children: children\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 18,\n    columnNumber: 5\n  }, this);\n}\n\n_c = TabPanel;\n\nfunction a11yProps(index) {\n  return {\n    id: `simple-tab-${index}`,\n    'aria-controls': `simple-tabpanel-${index}`\n  };\n}\n\nexport default function Schedule() {\n  _s();\n\n  const uid = useAuthState().user.uid;\n  const userAPICall = \"https://cs498rkuiucfp.herokuapp.com/api/users/\";\n  const resultsAPICall = \"https://cs498rkuiucfp.herokuapp.com/api/results/\";\n  const schedulesAPICall = \"https://cs498rkuiucfp.herokuapp.com/api/schedules/\";\n  const [value, setValue] = React.useState(0);\n  const [userClasses, setUserClasses] = React.useState([]);\n  const [allClasses, setAllClasses] = React.useState([]);\n  const [allResults, setAllResults] = React.useState([]);\n  const [allSchedules, setAllSchedules] = React.useState([]);\n  const [userSchedules, setUserSchedules] = React.useState([]);\n  const [searchInputValue, setSearchInputValue] = React.useState(\"\");\n  const [actor, setActor] = React.useState(false);\n  const [dialog, setDialog] = React.useState(false);\n  const [oldClassAdd, setOldClassAdd] = React.useState('');\n  const [oldClassAddGenerator, setOldClassAddGenerator] = React.useState('');\n  const [department, setDepartment] = React.useState('');\n  const [maxHours, setMaxHours] = React.useState('');\n  const [difficulty, setDifficulty] = React.useState('');\n  const [interests, setInterests] = React.useState('');\n  const [classRecommendation, setClassRecommendation] = React.useState([]);\n  const [allDepartment, setAllDepartment] = React.useState([]);\n  const [openAddError, setOpenAddError] = React.useState(false);\n  const [openAddSuccess, setOpenAddSuccess] = React.useState(false);\n  const [openRemoveSuccess, setOpenRemoveSuccess] = React.useState(false);\n  React.useEffect(() => {\n    retrieveAllResultsInfo();\n    retrieveAllSchedulesInfo();\n    retrieveUserClasses(); // eslint-disable-next-line\n  }, []);\n  React.useEffect(() => {\n    getListOfClasses(allSchedules); // eslint-disable-next-line\n  }, [allSchedules]);\n  React.useEffect(() => {\n    console.log(userClasses);\n    console.log(allSchedules);\n    filterClasses(userClasses, allSchedules); // eslint-disable-next-line\n  }, [allSchedules, userClasses]);\n  React.useEffect(() => {\n    filterClasses(userClasses, allSchedules); // eslint-disable-next-line\n  }, [userClasses]);\n  React.useEffect(() => {\n    setActor(!actor); // eslint-disable-next-line\n  }, [userSchedules]);\n\n  async function retrieveUserClasses() {\n    await axios.get(userAPICall + uid, {}).then(response => {\n      console.log(response.data.data.savedSchedule);\n      setUserClasses(response.data.data.savedSchedule);\n    }).catch(error => {\n      if (error.response.status === 404) {\n        createNewUser();\n      } else {\n        console.log(error);\n      }\n    });\n  }\n\n  async function retrieveAllResultsInfo() {\n    await axios.get(resultsAPICall, {}).then(response => {\n      setAllResults(response.data.data);\n      var allDepartments = response.data.data.map(item => item.department);\n      allDepartments = [...new Set(allDepartments)];\n      setAllDepartment(allDepartments);\n    }).catch(error => {\n      console.log(error);\n    });\n  }\n\n  async function retrieveAllSchedulesInfo() {\n    await axios.get(schedulesAPICall, {}).then(response => {\n      setAllSchedules(response.data.data);\n    }).catch(error => {\n      console.log(error);\n    });\n  }\n\n  async function createNewUser() {\n    await axios.post(userAPICall, {\n      uid: uid\n    }).then(setUserClasses([])).catch(error => {\n      console.log(error);\n    });\n  }\n\n  function filterClasses(currUserClasses, schedules) {\n    console.log(currUserClasses);\n\n    if (schedules) {\n      var currSchedules = schedules.filter(schedule => currUserClasses.includes(schedule.title));\n      currSchedules = currSchedules.map(function (el) {\n        el.id = el._id;\n        return el;\n      });\n      setUserSchedules(mapSchedules(currSchedules));\n    } else {\n      setUserSchedules([]);\n    }\n  }\n\n  function getListOfClasses(schedules) {\n    var classes = schedules.map(element => element.title);\n    classes = [...new Set(classes)];\n    classes = classes.map(element => {\n      return {\n        label: element\n      };\n    });\n    setAllClasses(classes);\n  }\n\n  const handleChange = (event, newValue) => {\n    setValue(newValue);\n  };\n\n  function onLogOut(e) {\n    const auth = getAuth();\n    signOut(auth).then(() => {\n      console.log(\"Successfully Logged Out\");\n    }).catch(error => {\n      console.log(error);\n    });\n  }\n\n  async function editSavedSchedule(newSchedule) {\n    await axios.put(userAPICall + uid, {\n      savedSchedule: newSchedule\n    }).then(response => {\n      retrieveUserClasses();\n    }).catch(error => {\n      console.log(error);\n    });\n  }\n\n  function onSearch(e) {\n    console.log(userClasses);\n    var currUserClass = userClasses;\n\n    if (searchInputValue.label !== \"\" && !currUserClass.includes(searchInputValue.label)) {\n      var check = checkConflict(searchInputValue.label, userClasses, allSchedules);\n\n      if (check.result) {\n        currUserClass.push(searchInputValue.label);\n        editSavedSchedule(currUserClass);\n      } else {\n        setOldClassAdd(check.oldClass);\n        handleOpen();\n      }\n    }\n  }\n\n  const handleOpen = () => {\n    setDialog(true);\n  };\n\n  const handleClose = () => {\n    setDialog(false);\n  };\n\n  function onDelete(e) {\n    var currUserClass = userClasses;\n    var currUserSchedule = userSchedules;\n\n    if (e !== \"\") {\n      var currClass;\n      currClass = currUserSchedule.filter(item => item.id === e)[0].title;\n\n      if (currUserClass.includes(currClass)) {\n        currUserClass = currUserClass.filter(item => item !== currClass);\n        currUserSchedule = currUserSchedule.filter(item => item.title !== e);\n        setUserSchedules(currUserSchedule);\n        editSavedSchedule(currUserClass);\n      }\n    }\n  }\n\n  function onSubmitFilter() {\n    var currAllResults = allResults;\n    var currAllSchedules = allSchedules;\n    var filterResults = currAllResults.filter(function (item) {\n      if (interests !== \"\") {\n        if (item.department === department && parseInt(maxHours) >= parseInt(item.creditHours) && item.difficulty === difficulty && item.courseTags.includes(interests)) {\n          return true;\n        } else {\n          return false;\n        }\n      } else {\n        if (item.department === department && parseInt(maxHours) >= parseInt(item.creditHours) && item.difficulty === difficulty) {\n          return true;\n        } else {\n          return false;\n        }\n      }\n    });\n\n    if (filterResults.length !== 0) {\n      setClassRecommendation(getRecommendationsSchedule(filterResults, currAllSchedules));\n    } else {\n      setClassRecommendation([]);\n    }\n  }\n\n  function getRecommendationsSchedule(filterResults, currAllSchedules) {\n    var tempResults = filterResults.map(function (item) {\n      var tempAllSchedules = currAllSchedules;\n      var courseTitle = item.department + \" \" + item.courseNumber;\n      console.log(courseTitle);\n      var filteredCourse = tempAllSchedules.filter(item => item.title === courseTitle);\n      var stringDays = \"\";\n      var stringTiming = \"\";\n\n      for (var classValue of filteredCourse) {\n        if (classValue.day === 1) {\n          stringDays = stringDays + \"M\";\n        } else if (classValue.day === 2) {\n          stringDays = stringDays + \"T\";\n        } else if (classValue.day === 3) {\n          stringDays = stringDays + \"W\";\n        } else if (classValue.day === 4) {\n          stringDays = stringDays + \"R\";\n        } else {\n          stringDays = stringDays + \"F\";\n        }\n      }\n\n      console.log(filteredCourse);\n      var startHour = parseInt(filteredCourse[0].startHour) % 12;\n\n      if (startHour === 0) {\n        startHour = 12;\n      }\n\n      var ampmStart = Math.floor(parseInt(filteredCourse[0].startHour) / 12);\n\n      if (ampmStart === 0) {\n        ampmStart = \"AM\";\n      } else {\n        ampmStart = \"PM\";\n      }\n\n      var endHour = parseInt(filteredCourse[0].endHour) % 12;\n\n      if (endHour === 0) {\n        endHour = 12;\n      }\n\n      var ampmEnd = Math.floor(parseInt(filteredCourse[0].endHour) / 12);\n\n      if (ampmEnd === 0) {\n        ampmEnd = \"AM\";\n      } else {\n        ampmEnd = \"PM\";\n      }\n\n      var startMin = parseInt(filteredCourse[0].startMin);\n\n      if (startMin < 10) {\n        startMin = \"0\" + filteredCourse[0].startMin.toString();\n      } else {\n        startMin = filteredCourse[0].startMin.toString();\n      }\n\n      var endMin = parseInt(filteredCourse[0].endMin);\n\n      if (endMin < 10) {\n        endMin = \"0\" + filteredCourse[0].endMin.toString();\n      } else {\n        endMin = filteredCourse[0].endMin.toString();\n      }\n\n      stringTiming = startHour.toString() + \":\" + startMin + ampmStart + \" - \" + endHour.toString() + \":\" + endMin + ampmEnd;\n      return {\n        department: item.department,\n        courseNumber: item.courseNumber,\n        courseName: item.courseName,\n        avgGPA: item.avgGPA,\n        days: stringDays,\n        timing: stringTiming\n      };\n    });\n    return tempResults;\n  }\n\n  function addRecommendedClass(classAdded) {\n    console.log(classAdded);\n    var currUserClass = userClasses;\n\n    if (!currUserClass.includes(classAdded)) {\n      var check = checkConflict(classAdded, userClasses, allSchedules);\n\n      if (check.result) {\n        currUserClass.push(classAdded);\n        editSavedSchedule(currUserClass);\n        handleOpenSuccessSnackBarGenerator();\n      } else {\n        setOldClassAddGenerator(check.oldClass);\n        handleOpenSnackBarGenerator();\n      }\n    }\n  }\n\n  function removeRecommendedClass(classRemoved) {\n    console.log(classRemoved);\n    var currUserClass = userClasses;\n    var currUserSchedule = userSchedules;\n\n    if (currUserClass.includes(classRemoved)) {\n      currUserClass = currUserClass.filter(item => item !== classRemoved);\n      currUserSchedule = currUserSchedule.filter(item => item.title !== classRemoved);\n      setUserSchedules(currUserSchedule);\n      editSavedSchedule(currUserClass);\n      handleRemoveOpenSuccessSnackBarGenerator();\n    }\n  }\n\n  function onChangeInterests(e) {\n    setInterests(e.target.value);\n  }\n\n  function onChangeMaxHour(e) {\n    setMaxHours(e.target.value);\n  }\n\n  function handleOpenSuccessSnackBarGenerator() {\n    setOpenAddSuccess(true);\n  }\n\n  function closeSuccessSnackBarGenerator() {\n    setOpenAddSuccess(false);\n  }\n\n  function handleRemoveOpenSuccessSnackBarGenerator() {\n    setOpenRemoveSuccess(true);\n  }\n\n  function closeRemoveSuccessSnackBarGenerator() {\n    setOpenRemoveSuccess(false);\n  }\n\n  function handleOpenSnackBarGenerator() {\n    setOpenAddError(true);\n  }\n\n  function closeSnackBarGenerator() {\n    setOpenAddError(false);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Box, {\n    children: /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 2,\n      justifyContent: \"center\",\n      alignItems: \"center\",\n      direction: \"row\",\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 12,\n        children: /*#__PURE__*/_jsxDEV(Box, {\n          display: \"flex\",\n          children: /*#__PURE__*/_jsxDEV(Box, {\n            m: \"auto\",\n            children: /*#__PURE__*/_jsxDEV(Tabs, {\n              value: value,\n              onChange: handleChange,\n              \"aria-label\": \"icon label tabs example\",\n              children: [/*#__PURE__*/_jsxDEV(Tab, {\n                icon: /*#__PURE__*/_jsxDEV(CalendarTodayIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 399,\n                  columnNumber: 28\n                }, this),\n                label: \"SCHEDULE GENERATOR\",\n                iconPosition: \"start\",\n                ...a11yProps(0)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 399,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Tab, {\n                icon: /*#__PURE__*/_jsxDEV(SearchIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 400,\n                  columnNumber: 28\n                }, this),\n                label: \"CLASS RECOMMENDATION\",\n                iconPosition: \"start\",\n                ...a11yProps(1)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 400,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 398,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          position: 'absolute',\n          right: '40px',\n          top: '20px'\n        },\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          color: \"warning\",\n          onClick: onLogOut,\n          size: \"medium\",\n          startIcon: /*#__PURE__*/_jsxDEV(LogoutIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 103\n          }, this),\n          children: \"Log Out\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 406,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TabPanel, {\n        value: value,\n        index: 0,\n        children: /*#__PURE__*/_jsxDEV(ScheduleGenerator, {\n          searchInputValue: searchInputValue,\n          setSearchInputValue: setSearchInputValue,\n          allClasses: allClasses,\n          onSearch: onSearch,\n          userSchedules: userSchedules,\n          onDelete: onDelete,\n          actor: actor,\n          dialog: dialog,\n          handleClose: handleClose,\n          oldClassAdd: oldClassAdd\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TabPanel, {\n        value: value,\n        index: 1,\n        children: /*#__PURE__*/_jsxDEV(Recommender, {\n          classRecommendation: classRecommendation,\n          department: department,\n          setDepartment: setDepartment,\n          difficulty: difficulty,\n          setDifficulty: setDifficulty,\n          onSubmitFilter: onSubmitFilter,\n          allDepartment: allDepartment,\n          userClasses: userClasses,\n          addRecommendedClass: addRecommendedClass,\n          oldClassAddGenerator: oldClassAddGenerator,\n          openAddError: openAddError,\n          closeSnackBarGenerator: closeSnackBarGenerator,\n          closeSuccessSnackBarGenerator: closeSuccessSnackBarGenerator,\n          openAddSuccess: openAddSuccess,\n          onChangeInterests: onChangeInterests,\n          onChangeMaxHour: onChangeMaxHour,\n          interests: interests,\n          maxHours: maxHours,\n          removeRecommendedClass: removeRecommendedClass,\n          closeRemoveSuccessSnackBarGenerator: closeRemoveSuccessSnackBarGenerator,\n          openRemoveSuccess: openRemoveSuccess\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 393,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Schedule, \"aYp0Pu8arMtYrsW/ny/PT2k+kh0=\", false, function () {\n  return [useAuthState];\n});\n\n_c2 = Schedule;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"TabPanel\");\n$RefreshReg$(_c2, \"Schedule\");","map":{"version":3,"sources":["/Users/vikram/Documents/School/CS498RK/finalproject/src/components/Scheduler/schedule.js"],"names":["React","useAuthState","getAuth","signOut","Button","Tabs","Tab","Box","Grid","Typography","CalendarTodayIcon","SearchIcon","LogoutIcon","mapSchedules","checkConflict","ScheduleGenerator","Recommender","axios","TabPanel","props","children","value","index","other","p","a11yProps","id","Schedule","uid","user","userAPICall","resultsAPICall","schedulesAPICall","setValue","useState","userClasses","setUserClasses","allClasses","setAllClasses","allResults","setAllResults","allSchedules","setAllSchedules","userSchedules","setUserSchedules","searchInputValue","setSearchInputValue","actor","setActor","dialog","setDialog","oldClassAdd","setOldClassAdd","oldClassAddGenerator","setOldClassAddGenerator","department","setDepartment","maxHours","setMaxHours","difficulty","setDifficulty","interests","setInterests","classRecommendation","setClassRecommendation","allDepartment","setAllDepartment","openAddError","setOpenAddError","openAddSuccess","setOpenAddSuccess","openRemoveSuccess","setOpenRemoveSuccess","useEffect","retrieveAllResultsInfo","retrieveAllSchedulesInfo","retrieveUserClasses","getListOfClasses","console","log","filterClasses","get","then","response","data","savedSchedule","catch","error","status","createNewUser","allDepartments","map","item","Set","post","currUserClasses","schedules","currSchedules","filter","schedule","includes","title","el","_id","classes","element","label","handleChange","event","newValue","onLogOut","e","auth","editSavedSchedule","newSchedule","put","onSearch","currUserClass","check","result","push","oldClass","handleOpen","handleClose","onDelete","currUserSchedule","currClass","onSubmitFilter","currAllResults","currAllSchedules","filterResults","parseInt","creditHours","courseTags","length","getRecommendationsSchedule","tempResults","tempAllSchedules","courseTitle","courseNumber","filteredCourse","stringDays","stringTiming","classValue","day","startHour","ampmStart","Math","floor","endHour","ampmEnd","startMin","toString","endMin","courseName","avgGPA","days","timing","addRecommendedClass","classAdded","handleOpenSuccessSnackBarGenerator","handleOpenSnackBarGenerator","removeRecommendedClass","classRemoved","handleRemoveOpenSuccessSnackBarGenerator","onChangeInterests","target","onChangeMaxHour","closeSuccessSnackBarGenerator","closeRemoveSuccessSnackBarGenerator","closeSnackBarGenerator","position","right","top"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { useAuthState } from '../auth/firebase'\nimport { getAuth, signOut } from '@firebase/auth'\nimport { Button, Tabs, Tab, Box, Grid, Typography } from '@mui/material';\nimport CalendarTodayIcon from '@mui/icons-material/CalendarToday';\nimport SearchIcon from '@mui/icons-material/Search';\nimport LogoutIcon from '@mui/icons-material/Logout';\nimport mapSchedules from \"./appointments\";\nimport checkConflict from \"./checkConflict\";\nimport ScheduleGenerator from \"./schedulegenerator\";\nimport Recommender from './recommender';\nimport axios from \"axios\";\n\nfunction TabPanel(props) {\n  const { children, value, index, ...other } = props;\n\n  return (\n    <div\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`simple-tabpanel-${index}`}\n      aria-labelledby={`simple-tab-${index}`}\n      {...other}\n    >\n      {value === index && (\n        <Box sx={{ p: 3 }}>\n          <Typography>{children}</Typography>\n        </Box>\n      )}\n    </div>\n  );\n}\n\nfunction a11yProps(index) {\n  return {\n    id: `simple-tab-${index}`,\n    'aria-controls': `simple-tabpanel-${index}`,\n  };\n}\n\nexport default function Schedule() {\n  \n  const uid = useAuthState().user.uid;\n  const userAPICall = \"https://cs498rkuiucfp.herokuapp.com/api/users/\"\n  const resultsAPICall = \"https://cs498rkuiucfp.herokuapp.com/api/results/\"\n  const schedulesAPICall = \"https://cs498rkuiucfp.herokuapp.com/api/schedules/\"\n  const [value, setValue] = React.useState(0);\n  const [userClasses, setUserClasses] = React.useState([]);\n  const [allClasses, setAllClasses] = React.useState([]);\n  const [allResults, setAllResults] = React.useState([]);\n  const [allSchedules, setAllSchedules] = React.useState([]);\n  const [userSchedules, setUserSchedules] = React.useState([]);\n  const [searchInputValue, setSearchInputValue] = React.useState(\"\");\n  const [actor, setActor] = React.useState(false);\n  const [dialog, setDialog] = React.useState(false);\n  const [oldClassAdd, setOldClassAdd] = React.useState('');\n  const [oldClassAddGenerator, setOldClassAddGenerator] = React.useState('');\n  const [department, setDepartment] = React.useState('');\n  const [maxHours, setMaxHours] = React.useState('');\n  const [difficulty, setDifficulty] = React.useState('');\n  const [interests, setInterests] = React.useState('');\n  const [classRecommendation, setClassRecommendation] = React.useState([]);\n  const [allDepartment, setAllDepartment] = React.useState([]);\n  const [openAddError, setOpenAddError] = React.useState(false);\n  const [openAddSuccess, setOpenAddSuccess] = React.useState(false);\n  const [openRemoveSuccess, setOpenRemoveSuccess] = React.useState(false);\n\n  React.useEffect(()=> {\n    retrieveAllResultsInfo();\n    retrieveAllSchedulesInfo();\n    retrieveUserClasses();\n    // eslint-disable-next-line\n  },[])\n\n  React.useEffect(()=> {\n    getListOfClasses(allSchedules)\n    // eslint-disable-next-line\n  },[allSchedules])\n\n\n  React.useEffect(()=> {\n    console.log(userClasses)\n    console.log(allSchedules)\n    filterClasses(userClasses, allSchedules);\n    // eslint-disable-next-line\n  },[allSchedules, userClasses])\n\n  React.useEffect(()=> {\n    filterClasses(userClasses, allSchedules);\n    // eslint-disable-next-line\n  },[userClasses])\n\n  React.useEffect(()=> {\n    setActor(!actor);\n    // eslint-disable-next-line\n  },[userSchedules])\n\n  async function retrieveUserClasses() {\n    await axios.get(userAPICall+uid, {}).then(response=> {\n      console.log(response.data.data.savedSchedule)\n      setUserClasses(response.data.data.savedSchedule);\n    })\n    .catch(error => {\n      if(error.response.status === 404) {\n        createNewUser()\n      } else {\n        console.log(error)\n      }\n    })\n  }\n\n  async function retrieveAllResultsInfo() {\n    await axios.get(resultsAPICall, {}).then(response=> {\n      setAllResults(response.data.data);\n      var allDepartments = response.data.data.map(item => item.department)\n      allDepartments = [...new Set(allDepartments)];\n      setAllDepartment(allDepartments);\n    })\n    .catch(error => {\n      console.log(error);\n    })\n  }\n\n  async function retrieveAllSchedulesInfo() {\n\n    await axios.get(schedulesAPICall, {}).then(response=> {\n      setAllSchedules(response.data.data);\n    })\n    .catch(error => {\n      console.log(error);\n    })\n  }\n\n  async function createNewUser() {\n    await axios.post(userAPICall, {\n      uid: uid\n    }).then(\n      setUserClasses([])\n    )\n    .catch(error => {\n      console.log(error);\n    })\n  }\n\n  function filterClasses(currUserClasses, schedules) {\n    console.log(currUserClasses)\n    if (schedules) {\n      var currSchedules = schedules.filter(schedule => currUserClasses.includes(schedule.title))\n      currSchedules = currSchedules.map(function(el) {\n        el.id = el._id\n        return el\n      })\n      setUserSchedules(mapSchedules(currSchedules));\n    } else {\n      setUserSchedules([])\n    }\n  }\n\n  function getListOfClasses(schedules) {\n    var classes = schedules.map(element =>element.title);\n    classes = [...new Set(classes)];\n    classes = classes.map(element =>{ return {label: element}});\n    setAllClasses(classes);\n  }\n  \n\n  const handleChange = (event, newValue) => {\n    setValue(newValue);\n  };\n\n  function onLogOut(e) {\n    const auth = getAuth();\n    signOut(auth).then( ()=> {\n      console.log(\"Successfully Logged Out\")\n    }).catch((error) => {\n      console.log(error);\n    });\n  }\n\n  async function editSavedSchedule(newSchedule) {\n    await axios.put(userAPICall+uid, {\n      savedSchedule: newSchedule\n    }).then(response=> {\n      retrieveUserClasses()\n    })\n    .catch(error => {\n      console.log(error);\n    })\n  }\n\n  function onSearch(e) {\n    console.log(userClasses)\n    var currUserClass = userClasses;\n    if (searchInputValue.label !== \"\" && !currUserClass.includes(searchInputValue.label)) {\n      var check = checkConflict(searchInputValue.label, userClasses, allSchedules);\n      if (check.result) {\n        currUserClass.push(searchInputValue.label);\n        editSavedSchedule(currUserClass);\n      } else {\n        setOldClassAdd(check.oldClass);\n        handleOpen();\n      }\n    }\n  }\n\n  const handleOpen = () => {\n    setDialog(true);\n  };\n\n  const handleClose = () => {\n    setDialog(false);\n  };\n\n  function onDelete(e) {\n    var currUserClass = userClasses;\n    var currUserSchedule = userSchedules;\n    if (e !== \"\") {\n      var currClass;\n      currClass = currUserSchedule.filter(item =>item.id === e)[0].title\n      if (currUserClass.includes(currClass)) {\n        currUserClass = currUserClass.filter(item => item !== currClass)\n        currUserSchedule = currUserSchedule.filter(item => item.title !== e)\n        setUserSchedules(currUserSchedule);\n        editSavedSchedule(currUserClass);\n      }\n    }\n  }\n\n  function onSubmitFilter() {\n    var currAllResults = allResults;\n    var currAllSchedules = allSchedules;\n    var filterResults = currAllResults.filter(function(item) {\n      if (interests !== \"\") {\n        if (item.department === department && parseInt(maxHours) >= parseInt(item.creditHours) && item.difficulty === difficulty && item.courseTags.includes(interests)) {\n              return true;\n        } else {\n          return false\n        }\n      } else {\n        if (item.department === department && parseInt(maxHours) >= parseInt(item.creditHours) && item.difficulty === difficulty) {\n          return true;\n        } else {\n          return false\n        }\n      }\n    });\n    if (filterResults.length !== 0) {\n      setClassRecommendation(getRecommendationsSchedule(filterResults, currAllSchedules));\n    } else {\n      setClassRecommendation([]);\n    }\n    \n  }\n\n  function getRecommendationsSchedule(filterResults, currAllSchedules) {\n    var tempResults = filterResults.map(function(item) {\n      var tempAllSchedules = currAllSchedules;\n      var courseTitle = item.department + \" \" + item.courseNumber;\n      console.log(courseTitle)\n      var filteredCourse = tempAllSchedules.filter(item => item.title === courseTitle)\n      var stringDays = \"\"\n      var stringTiming = \"\"\n\n      for(var classValue of filteredCourse) {\n        if (classValue.day === 1) {\n          stringDays = stringDays + \"M\";\n        } else if (classValue.day === 2) {\n          stringDays = stringDays + \"T\";\n        } else if (classValue.day === 3) {\n          stringDays = stringDays + \"W\";\n        } else if (classValue.day === 4) {\n          stringDays = stringDays + \"R\";\n        } else {\n          stringDays = stringDays + \"F\";\n        }\n      }\n      console.log(filteredCourse)\n      var startHour = parseInt(filteredCourse[0].startHour) % 12;\n      if (startHour === 0) {\n        startHour = 12;\n      }\n\n      var ampmStart = Math.floor(parseInt(filteredCourse[0].startHour) / 12)\n      if (ampmStart === 0) {\n        ampmStart = \"AM\";\n      } else {\n        ampmStart = \"PM\";\n      }\n\n      var endHour = parseInt(filteredCourse[0].endHour) % 12;\n      if (endHour === 0) {\n        endHour = 12;\n      }\n\n      var ampmEnd = Math.floor(parseInt(filteredCourse[0].endHour) / 12)\n      if (ampmEnd === 0) {\n        ampmEnd = \"AM\";\n      } else {\n        ampmEnd = \"PM\";\n      }\n\n      var startMin= parseInt(filteredCourse[0].startMin);\n      if(startMin < 10) {\n        startMin = \"0\" + filteredCourse[0].startMin.toString();\n      } else {\n        startMin = filteredCourse[0].startMin.toString();\n      }\n\n      var endMin= parseInt(filteredCourse[0].endMin);\n      if(endMin < 10) {\n        endMin = \"0\" + filteredCourse[0].endMin.toString();\n      } else {\n        endMin = filteredCourse[0].endMin.toString();\n      }\n\n      stringTiming = startHour.toString() + \":\" + startMin + ampmStart + \" - \" + endHour.toString() + \":\" + endMin + ampmEnd;\n      return {\n        department: item.department,\n        courseNumber: item.courseNumber,\n        courseName: item.courseName,\n        avgGPA: item.avgGPA,\n        days: stringDays,\n        timing: stringTiming\n      }\n\n    }\n    );\n    return tempResults;\n  }\n\n  function addRecommendedClass(classAdded) {\n    console.log(classAdded)\n    var currUserClass = userClasses;\n    if (!currUserClass.includes(classAdded)) {\n      var check = checkConflict(classAdded, userClasses, allSchedules);\n      if (check.result) {\n        currUserClass.push(classAdded);\n        editSavedSchedule(currUserClass);\n        handleOpenSuccessSnackBarGenerator();\n      } else {\n        setOldClassAddGenerator(check.oldClass);\n        handleOpenSnackBarGenerator();\n      }\n    }\n  }\n\n  function removeRecommendedClass(classRemoved) {\n    console.log(classRemoved)\n    var currUserClass = userClasses;\n    var currUserSchedule = userSchedules;\n    if (currUserClass.includes(classRemoved)) {\n      currUserClass = currUserClass.filter(item => item !== classRemoved)\n      currUserSchedule = currUserSchedule.filter(item => item.title !== classRemoved)\n      setUserSchedules(currUserSchedule);\n      editSavedSchedule(currUserClass);\n      handleRemoveOpenSuccessSnackBarGenerator()\n    }\n  }\n\n  function onChangeInterests(e) {\n    setInterests(e.target.value);\n  }\n\n  function onChangeMaxHour(e) {\n    setMaxHours(e.target.value);\n  }\n\n  function handleOpenSuccessSnackBarGenerator() {\n    setOpenAddSuccess(true);\n  }\n\n  function closeSuccessSnackBarGenerator() {\n    setOpenAddSuccess(false);\n  }\n\n  function handleRemoveOpenSuccessSnackBarGenerator() {\n    setOpenRemoveSuccess(true);\n  }\n\n  function closeRemoveSuccessSnackBarGenerator() {\n    setOpenRemoveSuccess(false);\n  }\n  \n  function handleOpenSnackBarGenerator() {\n    setOpenAddError(true);\n  }\n\n  function closeSnackBarGenerator() {\n    setOpenAddError(false);\n  }\n\n  return(\n    <Box>\n      <Grid container spacing={2} justifyContent=\"center\" alignItems=\"center\" direction=\"row\">\n        <Grid item xs={12}>\n          <Box display=\"flex\" >\n            <Box m=\"auto\">\n              <Tabs value={value} onChange={handleChange} aria-label=\"icon label tabs example\">\n                <Tab icon={<CalendarTodayIcon />} label=\"SCHEDULE GENERATOR\" iconPosition=\"start\" {...a11yProps(0)} />\n                <Tab icon={<SearchIcon />} label=\"CLASS RECOMMENDATION\" iconPosition=\"start\" {...a11yProps(1)} />\n              </Tabs>\n            </Box>\n          </Box>\n        </Grid>\n        <Box sx={{position: 'absolute', right: '40px', top: '20px'}}>\n          <Button variant=\"contained\" color = \"warning\" onClick = {onLogOut} size=\"medium\" startIcon={<LogoutIcon />}>Log Out</Button>\n        </Box>\n        <TabPanel value={value} index={0}>\n          <ScheduleGenerator \n            searchInputValue = {searchInputValue}\n            setSearchInputValue = {setSearchInputValue}\n            allClasses = {allClasses}\n            onSearch = {onSearch}\n            userSchedules = {userSchedules}\n            onDelete = {onDelete}\n            actor = {actor}\n            dialog = {dialog}\n            handleClose = {handleClose}\n            oldClassAdd = {oldClassAdd}\n          />\n        </TabPanel>\n        <TabPanel value={value} index={1}>\n            <Recommender\n              classRecommendation = {classRecommendation}\n              department = {department}\n              setDepartment = {setDepartment}\n              difficulty = {difficulty}\n              setDifficulty= {setDifficulty}\n              onSubmitFilter = {onSubmitFilter}\n              allDepartment = {allDepartment}\n              userClasses = {userClasses}\n              addRecommendedClass = {addRecommendedClass}\n              oldClassAddGenerator = {oldClassAddGenerator}\n              openAddError = {openAddError}\n              closeSnackBarGenerator = {closeSnackBarGenerator}\n              closeSuccessSnackBarGenerator = {closeSuccessSnackBarGenerator}\n              openAddSuccess = {openAddSuccess}\n              onChangeInterests = {onChangeInterests}\n              onChangeMaxHour = {onChangeMaxHour}\n              interests = {interests}\n              maxHours = {maxHours}\n              removeRecommendedClass = {removeRecommendedClass}\n              closeRemoveSuccessSnackBarGenerator = {closeRemoveSuccessSnackBarGenerator}\n              openRemoveSuccess = {openRemoveSuccess}\n\n            />\n        </TabPanel>\n\n     </Grid>\n    </Box>\n  )\n}"]},"metadata":{},"sourceType":"module"}